<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Марина Варфоломеева" />


<title>Выявление дифференциально-экспрессируемых пептидов</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<script src="libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">

/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}

/* some padding for disqus */
#disqus_thread {
  margin-top: 45px;
}

</style>

<link rel="stylesheet" href="libs/font-awesome-4.1.0/css/font-awesome.min.css"/>




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="libs/navigation-1.0/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {
    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: "h1.title, .toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
  padding-left: 10px;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/proteomics-course/">Proteomics course</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">Начало</a></li>
        <li class="dropdown">
          <a href="lecture-notes" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Конспект<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
<!--             <li class="dropdown-header">Начало работы</li>
--->
             <li><a href="00_introduction.html">О модуле Анализ протеомных данных</a></li>
             <li class="divider"></li>
             <li><a href="01_introduction_to_r.html">Знакомство с R</a></li>
             <li><a href="02_data_preprocessing.html">Предварительная обработка данных</a></li>
             <li><a href="03_classification.html">Классификация</a></li>
             <!--
             <li><a href="04_differential_expression_analysis.html">Выявление дифференциально-экспрессируемых пептидов</a></li>
             <li><a href="05_multivariate_methods_pca.html">Многомерные методы (PCA)</a></li>
--->
<!--             <li><a href="06_multivariate_methods_pls-da.html">Многомерные методы (PLS-DA)</a></li>
-->
          </ul>
        </li>
        <li><a href="resources.html">Ссылки и ресурсы</a></li>
        <li><a href="coding_practices.html">Правила хорошего кода</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">


<h1 class="title">Выявление дифференциально-экспрессируемых пептидов</h1>
<h4 class="author"><em>Марина Варфоломеева</em></h4>

</div>


<div id="-.--." class="section level1">
<h1>Исследовательская гипотеза. Нулевая гипотеза.</h1>
<p>Допустим, мы хотим сравнить ХХХ у ХХХ и ХХХ. Исходя из существующих исследований и общих знаний о ХХХ мы предполагаем, что ХХХ будет различаться у ХХХ (исследовательская гипотеза). Чтобы проверить исследовательскую гипотезу, нужно сформулировать нулевую гипотезу. Обычно нулевые гипотезы постулируют отсутствие каких либо различий, т.е. в этом случае, нулевая гипотеза говорит, что ХХХ не будет различаться.</p>
</div>
<div id="--." class="section level1">
<h1>Тестирование статистических гипотез.</h1>
<p>Мы проводим эксперимент (ХХХ), измеряем ХХХ [XXXXXXXXXXссылкиХХХХХХХ]. После этого рассчитываем статистику, которая позволит оценить разницу уровней ХХХ в эксперименте (например, t-критерий). Наблюдаемое в эксперименте значение статистики сравнивают со значением, которое было бы получено, если бы уровни ХХХ не различались (т.е. если нулевая гипотеза верна). Если это значение маловероятно получить, когда уровни ХХХ не различаются, то мы “отвергаем” нулевую гипотезу. Результаты нашего эксперимента говорят в пользу нашей исследовательской гипотезы.</p>
</div>
<div id="---" class="section level1">
<h1>Ошибки при статистических тестах</h1>
</div>
<div id="-" class="section level1">
<h1>Величина эффекта</h1>
</div>
<div id="-" class="section level1">
<h1>Мощность теста</h1>
</div>
<div id="----." class="section level1">
<h1>Способы выявления дифференциально экспрессируемых пептидов.</h1>
<p>Есть несколько способов измерить разницу экспрессии: - Fold change - t-тест - непараметрическая статистика - модификации (типа адаптивных порогов и пр.) или комбинации нескольких методов</p>
<div id="fold-change" class="section level2">
<h2>Fold change</h2>
<p>Fold change (FC)- исторически первый способ оценивать дифференциальную экспрессию. В те времена, когда повторности были дороги. Считаем, что эеспрессия меняется, если между группами она сильно отличается (в 1.5 или 2 раза).</p>
<p>Нужно оценить, во сколько раз экспрессия в одной группе больше, чем экспрессия в другой группе. FC - это пропорция, дробь, в числителе одна группа, в знаменателе другая. Пропорции распределены несимметрично вокруг 1. Сырые данные брать неудобно. Логарифмы распределены симметрично вокруг нуля. (пример среднего значения для пропорций и логарифмов).</p>
<p>Операции с логарифмами:</p>
<ul>
<li><span class="math inline"><em>l</em><em>o</em><em>g</em>(1)=0</span></li>
<li><span class="math inline"><em>l</em><em>o</em><em>g</em>(<em>a</em><em>b</em>)=<em>l</em><em>o</em><em>g</em>(<em>a</em>)+<em>l</em><em>o</em><em>g</em>(<em>b</em>)</span></li>
<li><span class="math inline"><em>l</em><em>o</em><em>g</em>(<em>a</em>/<em>b</em>)=<em>l</em><em>o</em><em>g</em>(<em>a</em>)−<em>l</em><em>o</em><em>g</em>(<em>b</em>)</span> - это и есть fold change</li>
</ul>
<p>Обычно, данные логарифмируют при помощи <code>log(data, base = 2)</code>. Тогда можно просто посчитать разницу логарифмов - это и будет fold change.</p>
</div>
<div id="t-" class="section level2">
<h2>t-тест</h2>
<p>Чтобы проверить гипотезу <span class="math inline"><em>H</em><sub>0</sub> : <em>A</em> − <em>B</em> = 0</span>, нужно знать <span class="math inline"><em>σ</em></span>. После этого можно воспользоваться t-тестом.</p>
<p><span class="math inline"><em>a</em><sub>1</sub>, <em>a</em><sub>2</sub>, ..., <em>a</em><sub><em>n</em></sub></span> и <span class="math inline"><em>b</em><sub>1</sub>, <em>b</em><sub>2</sub>, ..., <em>b</em><sub><em>m</em></sub></span> - множества наблюдений в двух группах</p>
<p><span class="math inline">$\dash A = \sum{a_i} / n$</span> и <span class="math inline">$\dash B = \sum{b_i} / m$</span> - средние значения</p>
<p><span class="math inline"><em>s</em><sub><em>a</em></sub><sup>2</sup></span> и <span class="math inline"><em>s</em><sub><em>b</em></sub><sup><em>b</em></sup></span> - дисперсии</p>
<p><span class="math inline">$t = \frac {\dash A - \dash B} {\sqrt{\frac{s^2_a}{N} + \frac{s^_b}{M}}}$</span> - Welch’s t-test</p>
<ul>
<li>если большой объем выборки, то t-статистика нормально распределена</li>
<li>если данные распределены нормально, то t-статистика подчиняется t-распределению при любом объеме выборки</li>
</ul>
<p>Далее обычные действия при t-тесте. Считаем t-статистику. Считаем вероятность получить такое значение при условии, что нулевая гипотеза верна. Если эта вероятность меньше заданного уровня значимости - отвергаем нулевую гипотезу.</p>
<p>График, где по одной оси логарифм экспрессии в одной группе, а по другой оси - в другой.</p>
<p>MAplot - график, где по одной оси (A) - среднее логарифмов экспрессии, а по другой оси (M) - разница средних логарифмов экспрессии. Часто оказывается, что большая разница средних логарифмов экспрессии наблюдается у генов с низким уровнем экспрессии.</p>
<p>Недостатки: пептиды с небольшой дисперсией чаще окажутся достоверными, лучше работает при большом числе повторностей</p>
</div>
<div id="moderated-t-test" class="section level2">
<h2>Moderated t-test</h2>
<p><span class="math inline">$t_{mod} = \frac {\dash A - \dash B}{s + s_o}$</span></p>
<p>данные для многих генов используются для оценки дисперсии</p>
<p>(см. ниже сравнение)</p>
<ul>
<li>Significance analysis of microarrays (SAM)</li>
<li>limma <span class="citation">(Ritchie et al. 2015)</span></li>
</ul>
</div>
<div id="anova" class="section level2">
<h2>ANOVA</h2>
<ul>
<li>Можно контролировать много факторов сразу</li>
<li>Нужно неск. повторностей (я бы сказала, что не меньше 4)</li>
<li>Должны выполняться условия применимости</li>
<li>После дисперсионного анализа нужны пост-хоки или заранее запланированные контрасты</li>
</ul>
</div>
<div id="bootstrap" class="section level2">
<h2>Bootstrap</h2>
<ul>
<li>Нет особенных предположений о форме распределения</li>
<li>Алгоритм: Считаем t-статистику. Много раз случайным образом переставляем данные между группами и снова считаем t-статистику, чтобы получить ее распределение после случайных перестановок. Считаем уровень значимости t-статистики, как долю пермутаций в которых получилось значение t-статистики больше данного.</li>
<li>Нужно разумное число повторностей (минимум 4-6), чтобы было что переставлять</li>
</ul>
<div id="--t----" class="section level3">
<h3>Проблемы с t-тестом: разная дисперсия экспрессии</h3>
<p>У разных пептидов может быть разная дисперсия экспрессии. График: несколько пептидов, по оси х группы, по оси н уровень экспрессии. То же самое можно в виде боксплота, если много значений (больше 5). Каким различиям средних мы будем больше верить - там гле большая или маленькая дисперсия?</p>
<p>volcano plot: по оси х разница средних логарифмов экспрессии, по оси y - <span class="math inline">−<em>l</em><em>o</em><em>g</em><sub>10</sub><em>p</em> − <em>v</em><em>a</em><em>l</em><em>u</em><em>e</em></span>. Граница уровня значимости на лог шкале <span class="math inline">−<em>l</em><em>o</em><em>g</em><sub>10</sub>0.01 = 2</span>, все что выше - значимо, все что ниже - нет. Сверху, справа и слева - пептиды, которы достоверно меняют экспрессию в ту и др. сторону больше чем в заданное число раз. Внизу справа и слева - пептиды, которые сильно но недостоверно меняют экспрессию.</p>
<p>Если у генов разная дисперсия, то не очень хорошо использовать среднее соотношение логарифмов. Если повторностей мало - оценки дисперсии нестабильны. Другие способы оценить дисперсию: - использовать другие гены (?) - empirical bayesian approach - moderated t-test - SAM and ad-hoc procedure</p>
</div>
<div id="--t---" class="section level3">
<h3>Проблемы с t-тестом: Множественные сравнения</h3>
<p>Далее, оценили дисперсию - тестируем каждый пептид. Для каждого пептида нам нужно протестировать нулевую гипотезу <span class="math inline"><em>H</em><sub>0</sub> : <em>e</em><em>x</em><em>p</em><em>r</em><sub><em>a</em></sub> = <em>e</em><em>x</em><em>p</em><em>r</em><sub><em>b</em></sub></span>. Допустим, мы используем t-критерий. Считаем t-статистику для данных, сравниваем с t-распределением с заданным числом свободы, полученным при условии, что нулевая гипотеза верна. Если наше значение t-критерия попадает в область значений, которые маловероятно получить, если нулевая гипотеза верна, то мы отвергаем нулевую гипотезу. В качестве границы будем использовать уровень значимости <span class="math inline"><em>α</em> = 0.05</span> или <span class="math inline"><em>α</em> = 0.01</span>. Но пептидов, которые мы хотим сравнить, много. И пептиды взяты из одних и тех же проб, т.е. отдельные сравнения не являются независимыми друг от друга.</p>
<p>Представьте себе, что мы сравниваем экспрессию 1000 пептидов, экспрессия которых на самом деле не различается в двух группах. Т.е.<span class="math inline"><em>H</em><sub>0</sub></span> на самом деле справедлива. По крайней мере в 50 из этих тестов будут получены <span class="math inline"><em>p</em> &lt; 0.05</span>, т.е. мы сделаем ошибку первого рода - найдем различия экспрессии там, где их нет. Это плохо. Слишком большое количество ошибок. Именно поэтому часто указывают не p-values, а FDR - false discovery rate.</p>
<ul>
<li>Число ошибок I рода на число сравнений. Per comparison error rate</li>
<li>Ожидаемое число ошибок. Per family error rate</li>
<li>Вероятность получить хотябы одну ошибку I рода. Family-wise error rate</li>
<li>Частота ложноположительных результатов. False discovery rate, FDR</li>
</ul>
<p>Чувствительность и специфичность?</p>
</div>
<div id="-" class="section level3">
<h3>Варианты действий</h3>
<ul>
<li>внести поправки в p-values, чтобы они отражали действительность. Консервативно. Много вариантов. От Борферрони до Хольма и Хохберга. false discovery rate correction, FDR (Benjamini–Hochberg procedure, Benjamini–Hochberg–Yekutieli procedure)</li>
<li>Эмпирическая баесовская статистика или оценки Штейна (? Stein estimators). False coverage statement rate.</li>
<li>не тестировать гипотезы, а использовать только разведочный анализ - для генерации гипотез, которые потом планируется проверить.</li>
</ul>
<p>Реальное использование t-критерия затруднительно: - если стандартные ошибки велики - недостоверно, даже если абсолютная величина различий велика - неправильные выводы - если стандарные ошибки малы - достоверно, даже если ничтожные различия экспрессии. - t-статистика, вычисленная на реальных данных может быть не t-распределена - неправильные выводы. - стандартные ошибки получаются неточными при небольшом числе реплик - неправильные выводы</p>
</div>
</div>
<div id="-fold-change--t--witten-and-tibshirani-2007." class="section level2">
<h2>Сравнение Fold change и t-статистики (Witten and Tibshirani, 2007).</h2>
<p>Основной вывод: лучше использовать модифицированную t-статистику или fold change. Основной аргумент при выборе между разными статистиками - что важнее с биологической точки зрения - разница в экспрессии или ее изменчивость.</p>
<p>Списки генов полученные при помощи t-критерия и Fold change будут разными: - Обычный t-критерий <span class="math inline">$t = \frac {\dash A - \dash B}{s}$</span>, <span class="math inline">$t = \frac {\dash A - \dash B} {\sqrt{\frac{s^2_a}{N} + \frac{s^_b}{M}}}$</span>. Выбирает гены, у которых небольшие SE - <span class="math inline">$FC = {\dash A - \dash B}$</span> (Guo et al., 2006, Choe et al., 2005). Выбирает гены, у которых самая большая разница экспрессии. - Модифицированный t-критерий (Witten, Tibshirani, 2007) <span class="math inline">$t_{mod} = \frac {\dash A - \dash B}{s + s_o}$</span>, где <span class="math inline"><em>s</em><sub><em>o</em></sub></span> - это константа, кот. минимизирует коэф. вариации <span class="math inline"><em>t</em><sub><em>m</em><em>o</em><em>d</em></sub></span>. Выбирает гены, у которых одновременно большая разница экспрессии и небольшие SE. <span class="math inline"><em>s</em><sub><em>o</em></sub></span> выбирается при помощи Significance Analysis of Microarrays (Tusher et al., 2001)</p>
</div>
<div id="---fold-change" class="section level2">
<h2>Адаптивный порог для Fold change</h2>
<p>Если при пороге отсечения 2 или 1.5 оказывается выбрано слишком большое число пептидов, можно применять “адаптивный порог” (Fukuoka et al., 2011). Спорный метод - субъективное число групп с разным пороговым уровнем экспрессии.</p>
<p>Алгоритм: Нужны две технические повторности, чтобы оценить распределение шума. Нормализуем данные. Логарифмируем. Считаем соотношение экспрессий между техническими повторностями. Делим на <span class="math inline"><em>i</em></span>-групп по значениям нормализованной экспрессии с численностью <span class="math inline"><em>N</em><sub><em>i</em></sub></span>. (Исключаем группы где оказалось меньше 100 генов/пептидов - писали для конференции когда-то). Для каждой группы выбрать случайным образом половину генов в группе и найти для них минимальную и максимальную FC (повторить <span class="math inline"><em>N</em><sub><em>i</em></sub>/2</span> раз). Рассчитать доверительный интервал среднего максимального и минимального FC. CIupper * constant - это верхняя граница достоверности для группы, а CIlower / constant - это нижняя граница достоверности для группы. Если увеличивать constant, то должен снижаться уровень ложноположительных срабатываний. Повторить для других групп. Найденные пороги используются для сравнения тритментов.</p>
<p>Аналогичные методы с разными порогами отсечения: (Tsien et al., 2002b, Draghici, 2002)</p>
<div id="--." class="section level3">
<h3>Эмпирическая баесовская статистика.</h3>
<hr />
<p>Применение: смотрим на “типичные” значения стандартных ошибок. Поскольку данные фиксированные и пептидов много, можно оценить как выглядят “типичные” стандартные ошибки у похожих пептидов.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2>Ссылки</h2>
<div id="refs" class="references">
<div id="ref-Ritchie_2015">
<p>Ritchie, M. E., B. Phipson, D. Wu, Y. Hu, C. W. Law, W. Shi, and G. K. Smyth. 2015. limma powers differential expression analyses for RNA-sequencing and microarray studies. Nucleic Acids Research 43:doi: 10.1093/nar/gkv007.</p>
</div>
</div>
</div>
</div>


<!-- some extra javascript for older browsers -->
<script type="text/javascript" src="libs/polyfill.js"></script>


<!-- bizible -->
<script type="text/javascript" src="//cdn.bizible.com/scripts/bizible.js" async=""></script>


<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

-->


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
